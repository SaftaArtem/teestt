<?php
$categories = $block->getCategoryCollection()->toArray();


unset($categories[2]);



foreach ($categories as &$cat)
    $cat['children'] = array();


foreach ($categories as $key=>$item) {
    if($item['include_in_menu'] == 0) {
        unset($categories[$key]);
    }
}

foreach ($categories as $id => &$cat)
{
    if ($cat['parent_id'] != 2)
        $categories[$cat['parent_id']]['children'][$id] = &$cat;
}

foreach (array_keys($categories) as $id)
{
    if ($categories[$id]['parent_id'] != 2)
        unset($categories[$id]);
}



//
//$html = '';
//foreach ($categories as $key=> $value){
//    if(!$value == null){
//        $html .= '<li>'.$categories[$key]["name"].'</li><ul>';
//        foreach ($value as $sub_key => $sub_value) {
//            if (!$sub_value == null) {
//                $html .= '<li>'.$categories[$sub_key]['name'].'</li><ul>';
//                foreach ($sub_value as $sub_sub_key=>$sub_sub_value){
//                    if(!$sub_sub_value == null) {
//                        $html .= '<li>'.$categories[$sub_sub_key]['name'].'</li><ul>';
//                        foreach ($sub_sub_value as $sss_key=>$sss_value) {
//                            echo '+++';
//                        }
//                        $html .= '</ul>';
//                    } else {
//                        $html .= '<li>'.$categories[$sub_sub_key]['name'].'</li>';
//                    }
//                }
//                $html .= '</ul>';
//            } else {
//                $html .= '<li>'.$categories[$sub_key]['name'].'</li>';
//            }
//        }
//        $html .= '</ul>';
//    } else {
//        $html .= '<li>'.$categories[$key]["name"].'</li>';
//    }
//}
//$html .= '</ul>';
//echo $html;


?>

